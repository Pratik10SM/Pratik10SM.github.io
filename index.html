<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Magic Number Trick - Animated</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body { font-family: 'Segoe UI', Arial, sans-serif; background: #f3f6fb; margin: 0; padding: 0; }
    .container { max-width: 430px; margin: 50px auto; background: #fff; border-radius: 10px; box-shadow: 0 2px 12px #0002; padding: 30px 20px; }
    h1 { text-align: center; color: #1e88e5; margin-bottom: 30px; }
    .step { font-size: 20px; text-align: center; margin-bottom: 18px; min-height: 32px; }
    .inputs { text-align: center; }
    input[type="number"] { font-size: 19px; padding: 8px 12px; width: 70%; border: 1px solid #ccc; border-radius: 5px; margin-bottom: 10px; }
    .btn { padding: 9px 22px; background: #1e88e5; color: #fff; border: none; border-radius: 5px; margin: 7px 0; cursor: pointer; font-size: 17px; }
    .btn:disabled { background: #b0bec5; cursor: not-allowed; }
    .numbers-list { margin: 22px auto 0; background: #e3f2fd; border-radius: 8px; padding: 16px 8px; min-height: 65px; width: 90%; transition: background 0.4s; }
    .numbers-list.animated { animation: pulse 0.6s; }
    @keyframes pulse { 0% { background: #e3f2fd; } 50% { background: #bbdefb; } 100% { background: #e3f2fd; } }
    .result { font-size: 23px; color: #43a047; text-align: center; margin: 25px 0 0 0; }
    .fadein { animation: fadeIn 0.7s; }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    .reset-btn { margin-top: 28px; display: block; margin-left: auto; margin-right: auto; }
  </style>
</head>
<body>
  <div class="container">
    <h1>Magic Number Trick</h1>
    <div class="step" id="step"></div>
    <div class="inputs">
      <input type="number" id="numberInput" placeholder="Enter number" min="100" max="999" autocomplete="off" />
      <button class="btn" id="submitBtn">Submit</button>
    </div>
    <div class="numbers-list" id="numbersList"></div>
    <div class="result" id="result"></div>
    <button class="btn reset-btn" id="resetBtn" style="display:none;">Restart Trick</button>
  </div>
  <script>
    const stepEl = document.getElementById('step');
    const numberInput = document.getElementById('numberInput');
    const submitBtn = document.getElementById('submitBtn');
    const numbersList = document.getElementById('numbersList');
    const resultEl = document.getElementById('result');
    const resetBtn = document.getElementById('resetBtn');

    // State
    let state = {
      step: 1,
      first: null,
      answer: null,
      third: null,
      fourth: null,
      fifth: null,
      sixth: null
    };

    function animateNumbers() {
      numbersList.classList.remove('animated');
      void numbersList.offsetWidth; // reflow
      numbersList.classList.add('animated');
    }

    function showStep() {
      numberInput.value = '';
      numberInput.type = (state.step === 1) ? 'number' : 'number';
      numberInput.min = (state.step === 1) ? 100 : undefined;
      numberInput.max = (state.step === 1) ? 999 : undefined;
      numberInput.disabled = false;
      submitBtn.disabled = false;
      resultEl.textContent = '';

      if(state.step === 1) {
        stepEl.innerHTML = "Step 1: Enter a <b>3-digit number</b>.";
        numbersList.innerHTML = '';
      }
      if(state.step === 2) {
        stepEl.innerHTML = "Step 2: Here's the magic answer:<br><b>" + state.answer + "</b><br><span style='font-size:15px;color:#757575;'>Subtract 2 from your number, put 2 in front.</span>";
        numbersList.innerHTML = `<b>First number:</b> ${state.first}`;
        animateNumbers();
        setTimeout(() => {
          state.step = 3;
          showStep();
        }, 1550);
        numberInput.disabled = true;
        submitBtn.disabled = true;
      }
      if(state.step === 3) {
        stepEl.innerHTML = "Step 3: Enter a <b>third number</b> (any number).";
        numbersList.innerHTML = `<b>First number:</b> ${state.first}<br><b>Answer:</b> ${state.answer}`;
        animateNumbers();
      }
      if(state.step === 4) {
        stepEl.innerHTML = "Calculating the <b>fourth number</b>:<br>999 - " + state.third + " = <b>" + state.fourth + "</b>";
        numbersList.innerHTML = `<b>First:</b> ${state.first}<br><b>Answer:</b> ${state.answer}<br><b>Third:</b> ${state.third}<br><b>Fourth:</b> ${state.fourth}`;
        animateNumbers();
        setTimeout(() => {
          state.step = 5;
          showStep();
        }, 1700);
        numberInput.disabled = true;
        submitBtn.disabled = true;
      }
      if(state.step === 5) {
        stepEl.innerHTML = "Step 5: Enter a <b>fifth number</b> (any number).";
        numbersList.innerHTML = `<b>First:</b> ${state.first}<br><b>Answer:</b> ${state.answer}<br><b>Third:</b> ${state.third}<br><b>Fourth:</b> ${state.fourth}`;
        animateNumbers();
      }
      if(state.step === 6) {
        stepEl.innerHTML = "Calculating the <b>sixth number</b>:<br>999 - " + state.fifth + " = <b>" + state.sixth + "</b>";
        numbersList.innerHTML = `<b>First:</b> ${state.first}<br><b>Answer:</b> ${state.answer}<br><b>Third:</b> ${state.third}<br><b>Fourth:</b> ${state.fourth}<br><b>Fifth:</b> ${state.fifth}<br><b>Sixth:</b> ${state.sixth}`;
        animateNumbers();
        setTimeout(() => {
          state.step = 7;
          showStep();
        }, 1700);
        numberInput.disabled = true;
        submitBtn.disabled = true;
      }
      if(state.step === 7) {
        stepEl.innerHTML = "Adding: <b>First + Third + Fourth + Fifth + Sixth</b>";
        let sum = state.first + state.third + state.fourth + state.fifth + state.sixth;
        numbersList.innerHTML = `<b>First:</b> ${state.first}<br><b>Answer:</b> ${state.answer}<br><b>Third:</b> ${state.third}<br><b>Fourth:</b> ${state.fourth}<br><b>Fifth:</b> ${state.fifth}<br><b>Sixth:</b> ${state.sixth}<br><br><b>Sum:</b> ${sum}`;
        animateNumbers();
        setTimeout(() => {
          resultEl.innerHTML = `<span class="fadein">âœ¨ The answer: <b>${sum}</b> <br>It matches the magic answer: <b>${state.answer}</b>!</span>`;
          resetBtn.style.display = '';
          numberInput.disabled = true;
          submitBtn.disabled = true;
        }, 1300);
      }
    }

    function nextStep(val) {
      if(state.step === 1) {
        if(isNaN(val) || val < 100 || val > 999) { alert('Please enter a 3-digit number (100-999).'); return; }
        state.first = val;
        state.answer = Number('2' + (val - 2));
        state.step = 2;
        showStep();
      }
      else if(state.step === 3) {
        if(isNaN(val)) { alert('Please enter a valid number.'); return; }
        state.third = val;
        state.fourth = Math.abs(999 - val);
        state.step = 4;
        showStep();
      }
      else if(state.step === 5) {
        if(isNaN(val)) { alert('Please enter a valid number.'); return; }
        state.fifth = val;
        state.sixth = Math.abs(999 - val);
        state.step = 6;
        showStep();
      }
    }

    submitBtn.onclick = () => {
      let val = parseInt(numberInput.value, 10);
      nextStep(val);
    };

    numberInput.addEventListener("keyup", function(event) {
      if (event.key === "Enter") submitBtn.click();
    });

    resetBtn.onclick = () => {
      state = { step: 1, first: null, answer: null, third: null, fourth: null, fifth: null, sixth: null };
      resetBtn.style.display = 'none';
      showStep();
    };

    // Start
    showStep();
  </script>
</body>
</html>
